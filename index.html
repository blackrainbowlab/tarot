<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Premium AI-powered tarot reading app with complete 78-card deck">
    <title>Mystical AI Tarot - Premium Experience</title>
    <style>
        /* Core Variables */
        :root {
            --gold: #F59E0B;
            --purple: #9333EA;
            --teal: #14B8A6;
            --pink: #EC4899;
            --dark: #0F172A;
            --success: #10B981;
            --danger: #EF4444;
            
            /* From stable app */
            --cosmic-purple: #6B46C1;
            --mystic-blue: #2563EB;
            --celestial-pink: #EC4899;
            --astral-teal: #14B8A6;
            --golden-accent: #F59E0B;
            --deep-night: #0F172A;
            --star-white: #F8FAFC;
            --success-green: #10B981;
            --error-red: #EF4444;
            
            --glass-white: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            --glass-blur: blur(20px);
            
            --transition-smooth: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* ==================== */
        /* CONVERSION GATEWAY LAYER */
        /* ==================== */
        
        .conversion-gateway {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0F172A 0%, #1E293B 50%, #334155 100%);
            z-index: 9999;
            overflow-y: auto;
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .conversion-gateway.hidden {
            opacity: 0;
            transform: scale(1.1);
            pointer-events: none;
        }

        .gateway-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Hero Section */
        .hero-section {
            text-align: center;
            margin-bottom: 50px;
            animation: fadeInDown 0.8s ease;
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hero-title {
            font-size: 3.5rem;
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, var(--gold), var(--pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .hero-subtitle {
            font-size: 1.3rem;
            color: #CBD5E1;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        /* Value Proposition */
        .value-props {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
            animation: fadeInUp 0.8s ease 0.2s both;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .value-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .value-item:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--gold);
        }

        .value-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .value-text {
            color: #CBD5E1;
            font-size: 0.95rem;
        }

        /* Email Capture Card */
        .capture-card {
            background: linear-gradient(135deg, rgba(147, 51, 234, 0.1), rgba(236, 72, 153, 0.1));
            border: 2px solid var(--gold);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(245, 158, 11, 0.2);
            animation: fadeInUp 0.8s ease 0.4s both;
            position: relative;
            overflow: hidden;
        }

        .capture-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(245, 158, 11, 0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .capture-badge {
            position: absolute;
            top: -15px;
            right: 30px;
            background: linear-gradient(135deg, var(--danger), var(--gold));
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .capture-title {
            font-size: 2rem;
            color: var(--gold);
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }

        .capture-subtitle {
            color: #CBD5E1;
            margin-bottom: 25px;
            font-size: 1.1rem;
            position: relative;
            z-index: 1;
        }

        .email-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .email-input {
            flex: 1;
            padding: 15px 20px;
            border-radius: 30px;
            border: 2px solid #475569;
            background: rgba(15, 23, 42, 0.8);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .email-input:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.2);
        }

        .email-submit {
            padding: 15px 35px;
            background: linear-gradient(135deg, var(--gold), var(--pink));
            border: none;
            border-radius: 30px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .email-submit:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(245, 158, 11, 0.4);
        }

        .skip-link {
            color: #64748B;
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.9rem;
            margin-top: 15px;
            display: inline-block;
            position: relative;
            z-index: 1;
            transition: color 0.3s ease;
        }

        .skip-link:hover {
            color: #94A3B8;
        }

        /* Trust & Social Proof */
        .trust-section {
            margin-top: 40px;
            animation: fadeInUp 0.8s ease 0.6s both;
        }

        .trust-badges {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .trust-badge {
            text-align: center;
            color: #94A3B8;
        }

        .trust-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--teal);
            display: block;
        }

        .trust-label {
            font-size: 0.9rem;
            margin-top: 5px;
        }

        /* Testimonials Grid */
        .testimonials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .testimonial-card {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .testimonial-stars {
            color: var(--gold);
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .testimonial-text {
            color: #CBD5E1;
            font-style: italic;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        .testimonial-author {
            color: var(--teal);
            font-size: 0.9rem;
            text-align: right;
        }

        /* Trial Reading Section */
        .trial-section {
            margin-top: 50px;
            text-align: center;
            animation: fadeInUp 0.8s ease 0.8s both;
        }

        .trial-title {
            font-size: 1.5rem;
            color: var(--gold);
            margin-bottom: 20px;
        }

        .trial-cards {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .trial-card {
            width: 120px;
            height: 180px;
            background: linear-gradient(135deg, #1E293B, #334155);
            border: 2px solid var(--gold);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .trial-card::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(245, 158, 11, 0.3), transparent);
            transition: width 0.3s ease, height 0.3s ease;
        }

        .trial-card:hover::before {
            width: 150%;
            height: 150%;
        }

        .trial-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 15px 40px rgba(245, 158, 11, 0.3);
        }

        .trial-button {
            padding: 15px 40px;
            background: linear-gradient(135deg, var(--purple), var(--pink));
            border: none;
            border-radius: 30px;
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .trial-button:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(147, 51, 234, 0.4);
        }

        .trial-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Countdown Timer */
        .countdown-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(90deg, var(--danger), var(--gold));
            padding: 10px;
            text-align: center;
            font-weight: bold;
            color: white;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        .countdown-timer {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .timer-unit {
            background: rgba(0, 0, 0, 0.3);
            padding: 5px 10px;
            border-radius: 5px;
        }

        /* Progress Indicator */
        .progress-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid var(--gold);
            border-radius: 15px;
            padding: 15px;
            z-index: 10000;
        }

        .progress-label {
            color: var(--gold);
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .progress-bar {
            width: 150px;
            height: 8px;
            background: #334155;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--gold), var(--pink));
            transition: width 0.5s ease;
        }

        /* Access Granted Overlay */
        .access-granted {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, var(--success), var(--teal));
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            z-index: 10001;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.5);
            transition: transform 0.5s ease;
        }

        .access-granted.show {
            transform: translate(-50%, -50%) scale(1);
        }

        .access-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: celebrate 1s ease;
        }

        @keyframes celebrate {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(10deg); }
        }

        .access-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: white;
        }

        .access-subtitle {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.9);
        }

        /* Conversion Toggle */
        .conversion-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #475569, #334155);
            border: 2px solid var(--gold);
            border-radius: 50px;
            padding: 10px 20px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            z-index: 10001;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .conversion-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(245, 158, 11, 0.4);
        }

        /* Hide main app until conversion complete */
        #mainApp {
            display: none;
        }

        #mainApp.revealed {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* ======================== */
        /* STABLE TAROT APP STYLES */
        /* ======================== */
        
        #mainApp * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        #mainApp {
            font-family: 'Cormorant Garamond', serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 25%, #7e22ce 50%, #1e3c72 100%);
            min-height: 100vh;
            color: var(--star-white);
            overflow-x: hidden;
            position: relative;
        }

        /* Focus styles for accessibility */
        #mainApp *:focus {
            outline: 2px solid var(--golden-accent);
            outline-offset: 4px;
            border-radius: 4px;
        }

        /* Cosmic Background */
        #mainApp .cosmic-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: var(--deep-night);
            overflow: hidden;
        }

        /* Static Gradient Orbs */
        #mainApp .gradient-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.4;
        }

        #mainApp .orb-1 {
            width: 600px;
            height: 600px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            top: -200px;
            left: -200px;
        }

        #mainApp .orb-2 {
            width: 800px;
            height: 800px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            bottom: -300px;
            right: -300px;
        }

        #mainApp .orb-3 {
            width: 500px;
            height: 500px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* Glass Panels */
        #mainApp .glass-panel {
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.05) 50%,
                rgba(255, 255, 255, 0.03) 100%);
            backdrop-filter: blur(20px) saturate(200%);
            -webkit-backdrop-filter: blur(20px) saturate(200%);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: 24px;
            padding: 32px;
            box-shadow: 
                0 8px 32px 0 rgba(31, 38, 135, 0.37),
                inset 0 1px 1px rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            animation: simpleFadeIn 0.8s ease-out;
            margin-bottom: 24px;
        }

        @keyframes simpleFadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Typography */
        #mainApp h1 {
            font-family: 'Cinzel', serif;
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: 600;
            text-align: center;
            margin-bottom: 20px;
            background: linear-gradient(135deg, 
                var(--golden-accent) 0%, 
                var(--celestial-pink) 25%, 
                var(--cosmic-purple) 50%, 
                var(--mystic-blue) 75%,
                var(--astral-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 40px rgba(147, 51, 234, 0.3);
            letter-spacing: 2px;
        }

        #mainApp .subtitle {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.4rem;
            font-weight: 300;
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 40px;
        }

        /* Container */
        #mainApp .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        /* Header Controls */
        #mainApp .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
            gap: 20px;
        }

        #mainApp .controls {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        #mainApp .control-btn {
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--star-white);
            padding: 12px 24px;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-family: 'Cormorant Garamond', serif;
            font-size: 1rem;
            font-weight: 400;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        #mainApp .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 10px 30px rgba(147, 51, 234, 0.3),
                inset 0 1px 1px rgba(255, 255, 255, 0.2);
            border-color: rgba(147, 51, 234, 0.5);
        }

        #mainApp .control-btn.active {
            background: linear-gradient(135deg, 
                var(--golden-accent) 0%, 
                var(--celestial-pink) 100%);
            color: var(--deep-night);
        }

        /* AI Chat Interface */
        #mainApp .ai-chat-button {
            position: fixed;
            bottom: 170px;
            right: 30px;
            background: linear-gradient(135deg, var(--cosmic-purple) 0%, var(--mystic-blue) 100%);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-smooth);
            z-index: 100;
            font-size: 1.5rem;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
            border: 2px solid var(--golden-accent);
        }

        #mainApp .ai-chat-button:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.6);
        }

        #mainApp .ai-chat-button.active {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.7);
        }

        #mainApp .ai-chat-panel {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 400px;
            max-width: 90vw;
            height: 500px;
            background: linear-gradient(135deg, 
                rgba(30, 60, 114, 0.95) 0%, 
                rgba(42, 82, 152, 0.95) 100%);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 2px solid var(--golden-accent);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            display: none;
            flex-direction: column;
            z-index: 999;
        }

        #mainApp .ai-chat-panel.active {
            display: flex;
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        #mainApp .ai-chat-header {
            padding: 20px;
            border-bottom: 1px solid var(--golden-accent);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #mainApp .ai-chat-title {
            font-family: 'Cinzel', serif;
            color: var(--golden-accent);
            font-size: 1.2rem;
        }

        #mainApp .ai-chat-close {
            background: transparent;
            border: none;
            color: var(--golden-accent);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
        }

        #mainApp .ai-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        #mainApp .ai-message, #mainApp .user-message {
            padding: 12px 16px;
            border-radius: 15px;
            max-width: 80%;
            word-wrap: break-word;
        }

        #mainApp .ai-message {
            background: linear-gradient(135deg, 
                rgba(245, 158, 11, 0.2) 0%, 
                rgba(236, 72, 153, 0.2) 100%);
            border: 1px solid var(--golden-accent);
            align-self: flex-start;
        }

        #mainApp .user-message {
            background: linear-gradient(135deg, 
                rgba(107, 70, 193, 0.3) 0%, 
                rgba(37, 99, 235, 0.3) 100%);
            border: 1px solid var(--mystic-blue);
            align-self: flex-end;
        }

        #mainApp .ai-chat-input-container {
            padding: 20px;
            border-top: 1px solid var(--golden-accent);
            display: flex;
            gap: 10px;
        }

        #mainApp .ai-chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 10px 15px;
            color: var(--star-white);
            font-family: 'Cormorant Garamond', serif;
            font-size: 1rem;
        }

        #mainApp .ai-chat-send {
            background: var(--golden-accent);
            color: var(--deep-night);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        #mainApp .ai-chat-send:hover {
            transform: scale(1.1);
            background: var(--celestial-pink);
        }

        /* Panels */
        #mainApp .insights-panel,
        #mainApp .daily-card-banner,
        #mainApp .history-panel,
        #mainApp .settings-panel {
            display: none;
        }

        #mainApp .insights-panel.active,
        #mainApp .daily-card-banner.active,
        #mainApp .history-panel.active,
        #mainApp .settings-panel.active {
            display: block;
            animation: simpleFadeIn 0.8s ease;
        }

        /* Spread Selection */
        #mainApp .spread-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-top: 32px;
        }

        #mainApp .spread-card {
            background: linear-gradient(135deg, 
                rgba(107, 70, 193, 0.1) 0%, 
                rgba(236, 72, 153, 0.1) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 28px;
            cursor: pointer;
            transition: var(--transition-smooth);
            position: relative;
            overflow: hidden;
            text-align: center;
        }

        #mainApp .spread-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 
                0 20px 40px rgba(147, 51, 234, 0.3),
                inset 0 1px 1px rgba(255, 255, 255, 0.2);
            border-color: rgba(245, 158, 11, 0.5);
            background: linear-gradient(135deg, 
                rgba(107, 70, 193, 0.2) 0%, 
                rgba(236, 72, 153, 0.2) 100%);
        }

        #mainApp .spread-card h3 {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            color: var(--golden-accent);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        #mainApp .spread-card p {
            font-size: 1rem;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Question Input */
        #mainApp .question-section {
            margin-bottom: 32px;
        }

        #mainApp .question-input {
            width: 100%;
            padding: 18px 28px;
            font-size: 1.1rem;
            font-family: 'Cormorant Garamond', serif;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.05) 0%, 
                rgba(255, 255, 255, 0.02) 100%);
            border: 2px solid transparent;
            border-image: linear-gradient(135deg, 
                rgba(245, 158, 11, 0.3), 
                rgba(147, 51, 234, 0.3));
            border-image-slice: 1;
            border-radius: 50px;
            color: var(--star-white);
            backdrop-filter: blur(10px);
            transition: var(--transition-smooth);
            outline: none;
        }

        #mainApp .question-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
            font-style: italic;
        }

        #mainApp .question-input:focus {
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.08) 0%, 
                rgba(255, 255, 255, 0.04) 100%);
            box-shadow: 
                0 0 30px rgba(245, 158, 11, 0.2),
                inset 0 1px 1px rgba(255, 255, 255, 0.1);
        }

        #mainApp .question-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 16px;
            justify-content: center;
        }

        #mainApp .suggestion-chip {
            background: linear-gradient(135deg, 
                rgba(245, 158, 11, 0.1) 0%, 
                rgba(236, 72, 153, 0.1) 100%);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: var(--golden-accent);
            padding: 8px 18px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: var(--transition-bounce);
            backdrop-filter: blur(10px);
        }

        #mainApp .suggestion-chip:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, 
                rgba(245, 158, 11, 0.2) 0%, 
                rgba(236, 72, 153, 0.2) 100%);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.3);
        }

        /* Card Deck */
        #mainApp .card-deck {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            padding: 40px;
            margin: 30px 0;
        }

        #mainApp .card-back {
            aspect-ratio: 2/3;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 2px solid transparent;
            border-image: linear-gradient(135deg, 
                var(--golden-accent), 
                var(--cosmic-purple));
            border-image-slice: 1;
            border-radius: 15px;
            cursor: pointer;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.3),
                inset 0 1px 1px rgba(255, 255, 255, 0.1);
        }

        #mainApp .card-back:hover {
            transform: translateY(-15px) rotateY(5deg) rotateX(5deg);
            box-shadow: 
                0 20px 40px rgba(147, 51, 234, 0.4),
                0 0 60px rgba(245, 158, 11, 0.2),
                inset 0 1px 1px rgba(255, 255, 255, 0.2);
        }

        /* Spread Area */
        #mainApp .spread-area {
            display: none;
            animation: simpleFadeIn 0.8s ease-out;
        }

        #mainApp .spread-area.active {
            display: block;
        }

        /* Cards Container */
        #mainApp .cards-container {
            display: grid;
            gap: 32px;
            margin: 40px 0;
            justify-items: center;
        }

        #mainApp .cards-container.one-card {
            grid-template-columns: 1fr;
        }

        #mainApp .cards-container.three-card {
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }

        #mainApp .cards-container.five-card {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        }

        #mainApp .cards-container.celtic-cross {
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        }

        #mainApp .card-position {
            text-align: center;
            opacity: 0;
            animation: cardSimpleReveal 0.8s ease-out forwards;
        }

        @keyframes cardSimpleReveal {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #mainApp .position-label {
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            color: var(--golden-accent);
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 3px;
            opacity: 0.8;
        }

        #mainApp .card {
            width: 200px;
            height: 300px;
            background: linear-gradient(135deg, 
                #fef3c7 0%, 
                #fbbf24 50%, 
                #f59e0b 100%);
            border: 3px solid var(--golden-accent);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.3),
                0 0 60px rgba(245, 158, 11, 0.2),
                inset 0 2px 2px rgba(255, 255, 255, 0.3),
                inset 0 -2px 2px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: var(--transition-smooth);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        #mainApp .card:hover {
            transform: translateY(-10px) rotateX(-5deg);
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.4),
                0 0 100px rgba(245, 158, 11, 0.3),
                inset 0 2px 2px rgba(255, 255, 255, 0.4);
        }

        #mainApp .card.reversed {
            transform: rotate(180deg);
        }

        #mainApp .card.reversed:hover {
            transform: rotate(180deg) translateY(-10px);
        }

        #mainApp .card-symbol {
            font-size: 3.5rem;
            margin-bottom: 20px;
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
        }

        #mainApp .card-name {
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: #1e3c72;
            margin-bottom: 12px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #mainApp .card-meaning {
            font-size: 0.85rem;
            color: #0f172a;
            text-align: center;
            line-height: 1.5;
            font-style: italic;
        }

        /* Modal */
        #mainApp .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        #mainApp .modal.active {
            display: flex;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        #mainApp .modal-content {
            background: linear-gradient(135deg, 
                rgba(30, 60, 114, 0.95) 0%, 
                rgba(42, 82, 152, 0.95) 100%);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid rgba(245, 158, 11, 0.3);
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.5),
                0 0 100px rgba(147, 51, 234, 0.3);
            position: relative;
        }

        #mainApp .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--golden-accent);
            color: var(--deep-night);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            font-weight: bold;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #mainApp .modal-close:hover {
            transform: rotate(90deg) scale(1.1);
            background: var(--celestial-pink);
        }

        /* Interpretation Panel */
        #mainApp .interpretation {
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.08) 0%, 
                rgba(255, 255, 255, 0.03) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 40px;
            margin-top: 40px;
            box-shadow: 
                0 8px 32px rgba(31, 38, 135, 0.37),
                inset 0 1px 1px rgba(255, 255, 255, 0.1);
        }

        #mainApp .interpretation h3 {
            font-family: 'Cinzel', serif;
            color: var(--golden-accent);
            font-size: 1.8rem;
            margin-bottom: 24px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-align: center;
        }

        /* Enhanced Interpretation Styles */
        #mainApp .reading-header {
            background: linear-gradient(135deg, 
                rgba(245, 158, 11, 0.1) 0%, 
                rgba(147, 51, 234, 0.1) 100%);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        #mainApp .reading-question {
            color: var(--golden-accent);
            font-size: 1.2rem;
            font-style: italic;
            text-align: center;
            margin-bottom: 20px;
            padding: 0 20px;
            line-height: 1.6;
        }

        #mainApp .cards-drawn-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
            padding: 24px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
        }

        #mainApp .card-summary {
            background: linear-gradient(135deg, 
                rgba(107, 70, 193, 0.15) 0%, 
                rgba(37, 99, 235, 0.15) 100%);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            border: 1px solid rgba(107, 70, 193, 0.3);
            transition: all 0.3s ease;
        }

        #mainApp .card-summary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(107, 70, 193, 0.3);
            border-color: var(--golden-accent);
        }

        #mainApp .card-summary-position {
            color: var(--astral-teal);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        #mainApp .card-summary-name {
            color: var(--star-white);
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 4px;
        }

        #mainApp .card-summary-orientation {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            font-style: italic;
        }

        #mainApp .interpretation-content {
            position: relative;
            padding: 32px;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.03) 0%, 
                rgba(255, 255, 255, 0.01) 100%);
            border-radius: 16px;
            margin-bottom: 32px;
        }

        #mainApp .interpretation-content::before {
            content: '"';
            position: absolute;
            top: -20px;
            left: 20px;
            font-size: 4rem;
            color: var(--golden-accent);
            opacity: 0.3;
            font-family: 'Georgia', serif;
        }

        #mainApp .interpretation-section {
            margin-bottom: 28px;
        }

        #mainApp .interpretation-section-title {
            color: var(--celestial-pink);
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(236, 72, 153, 0.2);
            font-family: 'Cinzel', serif;
            letter-spacing: 1px;
        }

        #mainApp .interpretation-text {
            color: var(--star-white);
            font-size: 1.15rem;
            line-height: 1.8;
            text-align: justify;
            opacity: 0.95;
        }

        #mainApp .interpretation-highlight {
            background: linear-gradient(135deg, 
                rgba(245, 158, 11, 0.2) 0%, 
                rgba(236, 72, 153, 0.2) 100%);
            border-left: 4px solid var(--golden-accent);
            padding: 20px;
            margin: 24px 0;
            border-radius: 8px;
            font-style: italic;
        }

        #mainApp .key-insights {
            background: linear-gradient(135deg, 
                rgba(20, 184, 166, 0.1) 0%, 
                rgba(107, 70, 193, 0.1) 100%);
            border-radius: 16px;
            padding: 24px;
            margin-top: 32px;
            border: 1px solid rgba(20, 184, 166, 0.3);
        }

        #mainApp .key-insights-title {
            color: var(--astral-teal);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 16px;
            text-align: center;
            font-family: 'Cinzel', serif;
        }

        #mainApp .insight-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        #mainApp .insight-bullet {
            color: var(--golden-accent);
            font-size: 1.5rem;
            margin-right: 12px;
            line-height: 1.2;
        }

        #mainApp .insight-text {
            color: var(--star-white);
            font-size: 1.05rem;
            line-height: 1.6;
            flex: 1;
        }

        #mainApp .reading-footer {
            text-align: center;
            padding-top: 24px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 32px;
        }

        #mainApp .reading-footer-text {
            color: rgba(255, 255, 255, 0.7);
            font-style: italic;
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Action Buttons */
        #mainApp .action-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-top: 32px;
            flex-wrap: wrap;
        }

        #mainApp button {
            background: linear-gradient(135deg, 
                var(--cosmic-purple) 0%, 
                var(--mystic-blue) 100%);
            color: var(--star-white);
            border: none;
            padding: 14px 32px;
            font-size: 1rem;
            font-family: 'Cormorant Garamond', serif;
            font-weight: 400;
            letter-spacing: 2px;
            text-transform: uppercase;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition-smooth);
            box-shadow: 
                0 4px 15px rgba(102, 126, 234, 0.4),
                inset 0 1px 1px rgba(255, 255, 255, 0.2);
        }

        #mainApp button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 
                0 8px 25px rgba(102, 126, 234, 0.6),
                0 0 40px rgba(102, 126, 234, 0.3),
                inset 0 1px 1px rgba(255, 255, 255, 0.3);
        }

        #mainApp button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Loading State */
        #mainApp .loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid transparent;
            border-top: 3px solid var(--golden-accent);
            border-right: 3px solid var(--cosmic-purple);
            border-bottom: 3px solid var(--celestial-pink);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        #mainApp .loading-text {
            display: flex;
            align-items: center;
            gap: 16px;
            justify-content: center;
            padding: 24px;
            color: var(--golden-accent);
            font-size: 1.1rem;
            font-style: italic;
            letter-spacing: 1px;
        }

        /* Sound Indicator */
        #mainApp .sound-indicator {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.05) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-smooth);
            z-index: 100;
            font-size: 1.5rem;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }

        #mainApp .sound-indicator:hover {
            transform: scale(1.1);
        }

        /* Settings */
        #mainApp .setting-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        #mainApp .toggle-switch {
            position: relative;
            width: 56px;
            height: 28px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        #mainApp .toggle-switch.active {
            background: linear-gradient(135deg, 
                var(--golden-accent) 0%, 
                var(--celestial-pink) 100%);
        }

        #mainApp .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 22px;
            height: 22px;
            background: var(--star-white);
            border-radius: 50%;
            transition: var(--transition-smooth);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        #mainApp .toggle-switch.active::after {
            transform: translateX(28px);
        }

        /* Messages */
        #mainApp .error-message {
            color: var(--error-red);
            text-align: center;
            padding: 16px;
            background: linear-gradient(135deg, 
                rgba(239, 68, 68, 0.1) 0%, 
                rgba(220, 38, 38, 0.1) 100%);
            border-radius: 12px;
            margin: 16px 0;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        #mainApp .success-message {
            color: var(--success-green);
            text-align: center;
            padding: 16px;
            background: linear-gradient(135deg, 
                rgba(16, 185, 129, 0.1) 0%, 
                rgba(5, 150, 105, 0.1) 100%);
            border-radius: 12px;
            margin: 16px 0;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }

            .value-props {
                grid-template-columns: 1fr;
            }

            .trial-cards {
                flex-direction: column;
                align-items: center;
            }

            .testimonials-grid {
                grid-template-columns: 1fr;
            }

            .email-form {
                flex-direction: column;
            }

            .email-submit {
                width: 100%;
            }

            #mainApp h1 { font-size: 2.5rem; }
            #mainApp .header { flex-direction: column; }
            #mainApp .controls { width: 100%; justify-content: center; }
            #mainApp .spread-grid { grid-template-columns: 1fr; }
            #mainApp .cards-container { grid-template-columns: 1fr !important; }
            #mainApp .card { width: 180px; height: 270px; }
            #mainApp .ai-chat-panel { 
                width: calc(100vw - 40px);
                right: 20px;
                bottom: 80px;
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- Countdown Timer Bar -->
    <div class="countdown-bar" id="countdownBar">
        <span>LIMITED TIME: Free AI Tarot Readings</span>
        <div class="countdown-timer">
            <span class="timer-unit" id="hours">02</span>:
            <span class="timer-unit" id="minutes">47</span>:
            <span class="timer-unit" id="seconds">33</span>
        </div>
        <span>Only 7 spots remaining!</span>
    </div>

    <!-- Conversion Gateway Layer -->
    <div class="conversion-gateway" id="conversionGateway">
        <div class="gateway-container">
            <!-- Hero Section -->
            <div class="hero-section">
                <h1 class="hero-title">Mystical AI Tarot</h1>
                <p class="hero-subtitle">
                    Discover your path with AI-powered spiritual guidance<br>
                    Join 50,000+ seekers on their journey to clarity
                </p>
            </div>

            <!-- Value Propositions -->
            <div class="value-props">
                <div class="value-item">
                    <div class="value-icon">🔮</div>
                    <div class="value-text">78-Card Deck<br>Complete Wisdom</div>
                </div>
                <div class="value-item">
                    <div class="value-icon">🤖</div>
                    <div class="value-text">AI Insights<br>Personalized Guidance</div>
                </div>
                <div class="value-item">
                    <div class="value-icon">📊</div>
                    <div class="value-text">Track Progress<br>Daily Readings</div>
                </div>
                <div class="value-item">
                    <div class="value-icon">🎯</div>
                    <div class="value-text">Multiple Spreads<br>Every Question</div>
                </div>
            </div>

            <!-- Email Capture Card -->
            <div class="capture-card">
                <div class="capture-badge">$97 VALUE</div>
                <h2 class="capture-title">Get 3 FREE Readings</h2>
                <p class="capture-subtitle">
                    Unlock instant access to your personalized tarot journey
                </p>
                
                <form id="emailForm" class="email-form">
                    <input type="email" class="email-input" placeholder="Enter your email for free access" required>
                    <button type="submit" class="email-submit">Start Free</button>
                </form>
                
                <div class="skip-link" onclick="skipToTrial()">
                    Try one card first (no email required) →
                </div>
            </div>

            <!-- Trust & Social Proof -->
            <div class="trust-section">
                <div class="trust-badges">
                    <div class="trust-badge">
                        <span class="trust-number">50K+</span>
                        <span class="trust-label">Active Users</span>
                    </div>
                    <div class="trust-badge">
                        <span class="trust-number">4.9/5</span>
                        <span class="trust-label">Rating</span>
                    </div>
                    <div class="trust-badge">
                        <span class="trust-number">1M+</span>
                        <span class="trust-label">Readings</span>
                    </div>
                </div>

                <div class="testimonials-grid">
                    <div class="testimonial-card">
                        <div class="testimonial-stars">⭐⭐⭐⭐⭐</div>
                        <div class="testimonial-text">"Incredibly accurate! The AI insights are mind-blowing."</div>
                        <div class="testimonial-author">- Sarah M.</div>
                    </div>
                    <div class="testimonial-card">
                        <div class="testimonial-stars">⭐⭐⭐⭐⭐</div>
                        <div class="testimonial-text">"Better than any in-person reading I've had."</div>
                        <div class="testimonial-author">- Michael R.</div>
                    </div>
                    <div class="testimonial-card">
                        <div class="testimonial-stars">⭐⭐⭐⭐⭐</div>
                        <div class="testimonial-text">"Life-changing guidance. I use it daily now."</div>
                        <div class="testimonial-author">- Emma L.</div>
                    </div>
                </div>
            </div>

            <!-- Trial Reading Section -->
            <div class="trial-section" id="trialSection" style="display: none;">
                <h3 class="trial-title">Try Your First Card</h3>
                <div class="trial-cards">
                    <div class="trial-card" onclick="drawTrialCard(this, 0)">🌙</div>
                    <div class="trial-card" onclick="drawTrialCard(this, 1)">⭐</div>
                    <div class="trial-card" onclick="drawTrialCard(this, 2)">🔮</div>
                </div>
                <button id="trialButton" class="trial-button" onclick="performTrialReading()" disabled>
                    Select a card above
                </button>
            </div>
        </div>
    </div>

    <!-- Progress Indicator -->
    <div class="progress-indicator" id="progressIndicator" style="display: none;">
        <div class="progress-label">Journey Progress</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
    </div>

    <!-- Access Granted Overlay -->
    <div class="access-granted" id="accessGranted">
        <div class="access-icon">🎉</div>
        <div class="access-title">Welcome to Your Journey!</div>
        <div class="access-subtitle">Full access unlocked - Loading your dashboard...</div>
    </div>

    <!-- Conversion Toggle Button -->
    <button class="conversion-toggle" onclick="toggleConversion()">
        Skip to App
    </button>

    <!-- Main App Container (Hidden Initially) -->
    <div id="mainApp">
        <!-- Static Cosmic Background -->
        <div class="cosmic-background">
            <div class="gradient-orb orb-1"></div>
            <div class="gradient-orb orb-2"></div>
            <div class="gradient-orb orb-3"></div>
        </div>
        
        <div class="container">
            <div class="header">
                <div style="width: 100%;">
                    <h1>Mystical AI Tarot</h1>
                    <p class="subtitle">Premium Reading Experience</p>
                </div>
                <div class="controls">
                    <button class="control-btn" onclick="window.app?.toggleDailyCard()">Daily Card</button>
                    <button class="control-btn" onclick="window.app?.toggleHistory()">History</button>
                    <button class="control-btn" onclick="window.app?.showDeckExplorer()">Deck (78)</button>
                    <button class="control-btn" onclick="window.app?.toggleInsights()">Insights</button>
                    <button class="control-btn" onclick="window.app?.toggleSettings()">Settings</button>
                </div>
            </div>

            <!-- Daily Card Banner -->
            <div class="daily-card-banner glass-panel" id="dailyCardBanner">
                <h3 style="font-family: 'Cinzel', serif; color: var(--golden-accent); margin-bottom: 20px; font-size: 1.6rem; text-transform: uppercase; letter-spacing: 2px; text-align: center;">Your Daily Card</h3>
                <div id="dailyCardDisplay"></div>
                <button onclick="window.app?.drawDailyCard()">Draw Today's Card</button>
            </div>

            <!-- Smart Insights Panel -->
            <div class="glass-panel insights-panel" id="insightsPanel">
                <div style="font-family: 'Cinzel', serif; color: var(--golden-accent); font-size: 1.5rem; margin-bottom: 20px; text-align: center;">AI Insights & Patterns</div>
                <div id="insightsContent">
                    <p style="text-align: center; opacity: 0.7;">Complete a few readings to see patterns emerge...</p>
                </div>
            </div>

            <!-- History Panel -->
            <div class="glass-panel history-panel" id="historyPanel">
                <h2 style="font-family: 'Cinzel', serif; color: var(--golden-accent); text-align: center; margin-bottom: 24px;">Your Reading History</h2>
                <div id="historyList">
                    <p style="opacity: 0.7; text-align: center;">No readings yet. Start your first reading below!</p>
                </div>
            </div>

            <!-- Settings Panel -->
            <div class="glass-panel settings-panel" id="settingsPanel">
                <h2 style="font-family: 'Cinzel', serif; color: var(--golden-accent); text-align: center; margin-bottom: 24px;">Settings</h2>
                <div class="setting-row">
                    <label>Sound Effects</label>
                    <div class="toggle-switch" id="soundToggle" onclick="window.app?.toggleSound()"></div>
                </div>
                <div class="setting-row">
                    <label>Include Reversed Cards</label>
                    <div class="toggle-switch active" id="reversalsToggle" onclick="window.app?.toggleReversals()"></div>
                </div>
                <div class="setting-row">
                    <label>Gemini API Key</label>
                    <input type="password" id="apiKeyInput" placeholder="Enter your API key" style="
                        background: rgba(255, 255, 255, 0.1);
                        border: 1px solid rgba(255, 255, 255, 0.2);
                        color: white;
                        padding: 8px 16px;
                        border-radius: 8px;
                        font-family: 'Cormorant Garamond', serif;
                        font-size: 1rem;
                        width: 200px;">
                    <button onclick="window.app?.saveApiKey()" style="padding: 8px 20px; font-size: 0.9rem;">Save</button>
                </div>
                <div style="text-align: center; margin-top: 20px; opacity: 0.7; font-size: 0.9rem;">
                    Get your free API key at:<br>
                    <a href="https://makersuite.google.com/app/apikey" target="_blank" style="color: var(--golden-accent);">Google AI Studio</a>
                </div>
            </div>

            <!-- Main Content -->
            <div id="main">
                <!-- Spread Selector -->
                <div class="glass-panel" id="spreadSelector">
                    <h2 style="text-align: center; font-family: 'Cinzel', serif; font-size: 1.8rem; margin-bottom: 32px; color: var(--golden-accent); text-transform: uppercase; letter-spacing: 3px;">Begin Your Journey</h2>
                    <p style="text-align: center; opacity: 0.7; margin-bottom: 24px;">
                        Drawing from a complete 78-card Tarot deck<br>
                        <span style="font-size: 0.9rem;">22 Major Arcana • 56 Minor Arcana (4 suits × 14 cards)</span>
                    </p>
                    
                    <div class="question-section">
                        <input type="text" id="userQuestion" class="question-input" placeholder="What wisdom do you seek?">
                        <div class="question-suggestions">
                            <div class="suggestion-chip" onclick="window.app?.setQuestion('What do I need to know today?')">Daily Wisdom</div>
                            <div class="suggestion-chip" onclick="window.app?.setQuestion('How can I improve my relationships?')">Relationships</div>
                            <div class="suggestion-chip" onclick="window.app?.setQuestion('What should I focus on in my career?')">Career Path</div>
                            <div class="suggestion-chip" onclick="window.app?.setQuestion('What is blocking my progress?')">Blockages</div>
                        </div>
                    </div>

                    <h3 style="text-align: center; font-family: 'Cinzel', serif; color: var(--astral-teal); margin-top: 32px; margin-bottom: 24px;">Choose Your Spread</h3>
                    <div class="spread-grid">
                        <div class="spread-card" onclick="window.app?.selectSpread('single')">
                            <h3>Single Card</h3>
                            <p>Quick insight into your current situation</p>
                        </div>
                        <div class="spread-card" onclick="window.app?.selectSpread('three')">
                            <h3>Three Cards</h3>
                            <p>Past, Present, and Future timeline</p>
                        </div>
                        <div class="spread-card" onclick="window.app?.selectSpread('five')">
                            <h3>Relationship</h3>
                            <p>Deep dive into connection dynamics</p>
                        </div>
                        <div class="spread-card" onclick="window.app?.selectSpread('celtic')">
                            <h3>Celtic Cross</h3>
                            <p>Comprehensive 10-card analysis</p>
                        </div>
                        <div class="spread-card" onclick="window.app?.selectSpread('career')">
                            <h3>Career Path</h3>
                            <p>Professional guidance and growth</p>
                        </div>
                        <div class="spread-card" onclick="window.app?.selectSpread('chakra')">
                            <h3>Chakra Balance</h3>
                            <p>Energy center alignment reading</p>
                        </div>
                        <div class="spread-card" onclick="window.app?.selectSpread('yes-no')">
                            <h3>Yes/No</h3>
                            <p>Direct answer to specific question</p>
                        </div>
                        <div class="spread-card" onclick="window.app?.selectSpread('month')">
                            <h3>Month Ahead</h3>
                            <p>Four-week future forecast</p>
                        </div>
                    </div>
                </div>
                
                <!-- Card Deck -->
                <div class="glass-panel card-deck" id="cardDeck" style="display: none;">
                    <div class="card-back" onclick="window.app?.drawCards()">🌙</div>
                    <div class="card-back" onclick="window.app?.drawCards()">⭐</div>
                    <div class="card-back" onclick="window.app?.drawCards()">🔮</div>
                    <div class="card-back" onclick="window.app?.drawCards()">✨</div>
                    <div class="card-back" onclick="window.app?.drawCards()">🌟</div>
                    <div class="card-back" onclick="window.app?.drawCards()">💫</div>
                    <div class="card-back" onclick="window.app?.drawCards()">🌙</div>
                    <div class="card-back" onclick="window.app?.drawCards()">⭐</div>
                </div>
                
                <!-- Spread Area -->
                <div class="spread-area" id="spreadArea">
                    <div class="cards-container" id="cardsContainer"></div>
                    
                    <div class="interpretation" id="interpretation" style="display: none;">
                        <h3>Your Divine Interpretation</h3>
                        <div id="interpretationText"></div>
                        
                        <div class="action-buttons">
                            <button onclick="window.app?.saveReading()">Save</button>
                            <button onclick="window.app?.shareReading()">Share</button>
                            <button onclick="window.app?.resetReading()">New Reading</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Card Detail Modal -->
        <div class="modal" id="cardModal">
            <div class="modal-content">
                <button class="modal-close" onclick="window.app?.closeModal()">×</button>
                <h2 id="modalTitle"></h2>
                <div id="modalBody"></div>
            </div>
        </div>

        <!-- Sound Toggle -->
        <div class="sound-indicator" onclick="window.app?.toggleSound()">
            <span id="soundIcon">🔇</span>
        </div>

        <!-- AI Chat Button -->
        <div class="ai-chat-button" onclick="window.app?.toggleAIChat()">
            <span>🤖</span>
        </div>

        <!-- AI Chat Panel -->
        <div class="ai-chat-panel" id="aiChatPanel">
            <div class="ai-chat-header">
                <div class="ai-chat-title">AI Tarot Guide</div>
                <button class="ai-chat-close" onclick="window.app?.closeAIChat()">×</button>
            </div>
            
            <div class="ai-chat-messages" id="aiChatMessages">
                <div class="ai-message">Welcome! I'm your AI tarot guide. Ask me anything about your reading or card meanings!</div>
            </div>
            
            <div class="ai-chat-input-container">
                <input type="text" class="ai-chat-input" id="aiChatInput" placeholder="Ask about your reading..." onkeypress="if(event.key==='Enter') window.app?.sendAIMessage()">
                <button class="ai-chat-send" onclick="window.app?.sendAIMessage()">➤</button>
            </div>
        </div>
    </div>

    <script>
        // Complete Tarot App with Gateway and Enhanced Interpretation
        class TarotApp {
            constructor() {
                this.state = {
                    currentSpread: null,
                    drawnCards: [],
                    userQuestion: '',
                    readingHistory: [],
                    dailyCard: null,
                    aiChatHistory: [],
                    settings: {
                        soundEnabled: false,
                        reversalsEnabled: true,
                        apiKey: ''
                    }
                };

                this.spreads = {
                    single: { name: 'Single Card', positions: ['Present Situation'], count: 1 },
                    three: { name: 'Past-Present-Future', positions: ['Past', 'Present', 'Future'], count: 3 },
                    five: { name: 'Relationship', positions: ['You', 'Partner', 'Connection', 'Challenges', 'Outcome'], count: 5 },
                    celtic: { 
                        name: 'Celtic Cross', 
                        positions: ['Present', 'Challenge', 'Distant Past', 'Recent Past', 'Possible Outcome', 
                                  'Immediate Future', 'Your Approach', 'External Influences', 'Hopes/Fears', 'Final Outcome'], 
                        count: 10 
                    },
                    career: { name: 'Career Path', positions: ['Current Position', 'Strengths', 'Challenges', 'Opportunities', 'Action', 'Outcome'], count: 6 },
                    chakra: { 
                        name: 'Chakra Balance', 
                        positions: ['Root', 'Sacral', 'Solar Plexus', 'Heart', 'Throat', 'Third Eye', 'Crown'], 
                        count: 7 
                    },
                    'yes-no': { name: 'Yes/No', positions: ['Answer'], count: 1 },
                    month: { name: 'Month Ahead', positions: ['Week 1', 'Week 2', 'Week 3', 'Week 4'], count: 4 }
                };

                this.tarotDeck = this.initializeDeck();
                this.init();
            }

            init() {
                this.loadSettings();
                this.loadHistory();
                console.log(`Tarot App Initialized: ${this.tarotDeck.length} cards loaded`);
            }

            initializeDeck() {
                return [
                    // Major Arcana (0-21)
                    { symbol: "🎭", name: "The Fool", meaning: "New beginnings, innocence, spontaneity", reversed: "Recklessness, risk-taking" },
                    { symbol: "🎩", name: "The Magician", meaning: "Manifestation, resourcefulness, power", reversed: "Manipulation, poor planning" },
                    { symbol: "🔮", name: "The High Priestess", meaning: "Intuition, sacred knowledge", reversed: "Secrets, disconnected from intuition" },
                    { symbol: "👑", name: "The Empress", meaning: "Femininity, beauty, nature, abundance", reversed: "Creative block, dependence" },
                    { symbol: "⚔️", name: "The Emperor", meaning: "Authority, structure, control", reversed: "Tyranny, rigidity, coldness" },
                    { symbol: "📿", name: "The Hierophant", meaning: "Spiritual wisdom, tradition", reversed: "Personal beliefs, freedom" },
                    { symbol: "💕", name: "The Lovers", meaning: "Love, harmony, relationships", reversed: "Disharmony, imbalance" },
                    { symbol: "🏇", name: "The Chariot", meaning: "Control, willpower, success", reversed: "Lack of control, aggression" },
                    { symbol: "🦁", name: "Strength", meaning: "Inner strength, courage, patience", reversed: "Self doubt, weakness" },
                    { symbol: "🕯️", name: "The Hermit", meaning: "Soul searching, introspection", reversed: "Isolation, loneliness" },
                    { symbol: "☸️", name: "Wheel of Fortune", meaning: "Good luck, karma, life cycles", reversed: "Bad luck, lack of control" },
                    { symbol: "⚖️", name: "Justice", meaning: "Justice, fairness, truth", reversed: "Unfairness, dishonesty" },
                    { symbol: "🔄", name: "The Hanged Man", meaning: "Suspension, letting go", reversed: "Martyrdom, indecision" },
                    { symbol: "💀", name: "Death", meaning: "Endings, beginnings, transformation", reversed: "Resistance to change" },
                    { symbol: "🏺", name: "Temperance", meaning: "Balance, moderation, patience", reversed: "Imbalance, excess" },
                    { symbol: "😈", name: "The Devil", meaning: "Bondage, addiction, materialism", reversed: "Releasing limiting beliefs" },
                    { symbol: "⚡", name: "The Tower", meaning: "Sudden change, upheaval, chaos", reversed: "Personal transformation" },
                    { symbol: "⭐", name: "The Star", meaning: "Hope, faith, purpose, renewal", reversed: "Lack of faith, despair" },
                    { symbol: "🌙", name: "The Moon", meaning: "Illusion, fear, anxiety", reversed: "Release of fear" },
                    { symbol: "☀️", name: "The Sun", meaning: "Joy, success, celebration", reversed: "Inner child, feeling down" },
                    { symbol: "🎺", name: "Judgement", meaning: "Reflection, reckoning", reversed: "Self doubt, inner critic" },
                    { symbol: "🌍", name: "The World", meaning: "Completion, accomplishment", reversed: "Lack of closure" },
                    
                    // Suit of Wands (22-35) - Fire
                    { symbol: "🔥✨", name: "Ace of Wands", meaning: "Inspiration, new opportunities, growth", reversed: "Lack of direction, delays" },
                    { symbol: "🔥🌍", name: "Two of Wands", meaning: "Planning, making decisions", reversed: "Fear of change, poor planning" },
                    { symbol: "🔥👁️", name: "Three of Wands", meaning: "Expansion, foresight", reversed: "Playing small, lack of foresight" },
                    { symbol: "🔥🏡", name: "Four of Wands", meaning: "Celebration, harmony, home", reversed: "Lack of harmony, transition" },
                    { symbol: "🔥⚔️", name: "Five of Wands", meaning: "Competition, conflict", reversed: "Avoiding conflict, respecting differences" },
                    { symbol: "🔥🏆", name: "Six of Wands", meaning: "Success, public recognition", reversed: "Private achievement, personal success" },
                    { symbol: "🔥🛡️", name: "Seven of Wands", meaning: "Challenge, perseverance", reversed: "Exhaustion, giving up" },
                    { symbol: "🔥⚡", name: "Eight of Wands", meaning: "Movement, fast change", reversed: "Delays, frustration" },
                    { symbol: "🔥💪", name: "Nine of Wands", meaning: "Courage, persistence", reversed: "Exhaustion, lack of resources" },
                    { symbol: "🔥📦", name: "Ten of Wands", meaning: "Burden, responsibility", reversed: "Doing it all, carrying burden" },
                    { symbol: "🔥📖", name: "Page of Wands", meaning: "Enthusiasm, exploration", reversed: "Lack of direction" },
                    { symbol: "🔥🏇", name: "Knight of Wands", meaning: "Energy, passion, adventure", reversed: "Anger, impulsiveness" },
                    { symbol: "🔥👸", name: "Queen of Wands", meaning: "Confidence, independence", reversed: "Self-respect, self-confidence" },
                    { symbol: "🔥🦁", name: "King of Wands", meaning: "Natural leader, vision", reversed: "Impulsiveness, haste" },
                    
                    // Suit of Cups (36-49) - Water
                    { symbol: "💧❤️", name: "Ace of Cups", meaning: "Love, new relationships", reversed: "Self-love, intuition" },
                    { symbol: "💧💫", name: "Two of Cups", meaning: "Partnership, unity", reversed: "Self-love, break-up" },
                    { symbol: "💧🎉", name: "Three of Cups", meaning: "Celebration, friendship", reversed: "Independence, alone time" },
                    { symbol: "💧🧘", name: "Four of Cups", meaning: "Meditation, contemplation", reversed: "Retreat, withdrawal" },
                    { symbol: "💧😢", name: "Five of Cups", meaning: "Loss, grief", reversed: "Acceptance, moving on" },
                    { symbol: "💧🎁", name: "Six of Cups", meaning: "Nostalgia, happy memories", reversed: "Moving forward" },
                    { symbol: "💧☁️", name: "Seven of Cups", meaning: "Choices, fantasy", reversed: "Clarity, personal values" },
                    { symbol: "💧🚶", name: "Eight of Cups", meaning: "Walking away", reversed: "Fear of change" },
                    { symbol: "💧😊", name: "Nine of Cups", meaning: "Satisfaction, luxury", reversed: "Inner happiness" },
                    { symbol: "💧🌈", name: "Ten of Cups", meaning: "Harmony, happiness", reversed: "Misalignment of values" },
                    { symbol: "💧🐠", name: "Page of Cups", meaning: "Creative opportunities", reversed: "New ideas, doubting intuition" },
                    { symbol: "💧🤴", name: "Knight of Cups", meaning: "Romance, charm", reversed: "Jealousy, moodiness" },
                    { symbol: "💧👸", name: "Queen of Cups", meaning: "Compassion, calm", reversed: "Martyrdom, insecurity" },
                    { symbol: "💧🔱", name: "King of Cups", meaning: "Compassion, control", reversed: "Coldness, moodiness" },
                    
                    // Suit of Swords (50-63) - Air
                    { symbol: "⚔️💡", name: "Ace of Swords", meaning: "New ideas, mental clarity", reversed: "Inner clarity, re-thinking" },
                    { symbol: "⚔️👁️", name: "Two of Swords", meaning: "Difficult choices", reversed: "Lesser of two evils" },
                    { symbol: "⚔️💔", name: "Three of Swords", meaning: "Heartbreak, suffering", reversed: "Recovery, forgiveness" },
                    { symbol: "⚔️😴", name: "Four of Swords", meaning: "Rest, restoration", reversed: "Restlessness, burnout" },
                    { symbol: "⚔️🥊", name: "Five of Swords", meaning: "Conflict, disagreements", reversed: "Reconciliation" },
                    { symbol: "⚔️⛵", name: "Six of Swords", meaning: "Transition, moving on", reversed: "Emotional baggage" },
                    { symbol: "⚔️🦊", name: "Seven of Swords", meaning: "Deception, trickery", reversed: "Coming clean" },
                    { symbol: "⚔️🔗", name: "Eight of Swords", meaning: "Imprisonment, entrapment", reversed: "Self acceptance" },
                    { symbol: "⚔️😰", name: "Nine of Swords", meaning: "Anxiety, worry", reversed: "Hope, reaching out" },
                    { symbol: "⚔️🌅", name: "Ten of Swords", meaning: "Betrayal, defeat", reversed: "Recovery, regeneration" },
                    { symbol: "⚔️📚", name: "Page of Swords", meaning: "Curiosity, restlessness", reversed: "Deception, manipulation" },
                    { symbol: "⚔️🏇", name: "Knight of Swords", meaning: "Ambitious, action-oriented", reversed: "Restless, unfocused" },
                    { symbol: "⚔️❄️", name: "Queen of Swords", meaning: "Complexity, perceptiveness", reversed: "Cold hearted, cruel" },
                    { symbol: "⚔️⚖️", name: "King of Swords", meaning: "Mental clarity, authority", reversed: "Manipulative, cruel" },
                    
                    // Suit of Pentacles (64-77) - Earth
                    { symbol: "💰🌱", name: "Ace of Pentacles", meaning: "Opportunity, prosperity", reversed: "Lost opportunity" },
                    { symbol: "💰🔄", name: "Two of Pentacles", meaning: "Balance, adaptability", reversed: "Imbalance, disorganization" },
                    { symbol: "💰🗝️", name: "Three of Pentacles", meaning: "Teamwork, collaboration", reversed: "Disorganized, conflict" },
                    { symbol: "💰🔒", name: "Four of Pentacles", meaning: "Conservation, frugality", reversed: "Greediness, stinginess" },
                    { symbol: "💰❄️", name: "Five of Pentacles", meaning: "Need, poverty", reversed: "Recovery, charity" },
                    { symbol: "💰🤝", name: "Six of Pentacles", meaning: "Charity, generosity", reversed: "Strings attached" },
                    { symbol: "💰🌾", name: "Seven of Pentacles", meaning: "Hard work, perseverance", reversed: "Lack of reward" },
                    { symbol: "💰🔨", name: "Eight of Pentacles", meaning: "Apprenticeship, passion", reversed: "Lack of passion" },
                    { symbol: "💰🦚", name: "Nine of Pentacles", meaning: "Fruits of labor, luxury", reversed: "Reckless spending" },
                    { symbol: "💰🏰", name: "Ten of Pentacles", meaning: "Legacy, inheritance", reversed: "Fleeting success" },
                    { symbol: "💰📖", name: "Page of Pentacles", meaning: "Ambition, diligence", reversed: "Lack of commitment" },
                    { symbol: "💰🐂", name: "Knight of Pentacles", meaning: "Efficiency, hard work", reversed: "Laziness, obsessiveness" },
                    { symbol: "💰🌻", name: "Queen of Pentacles", meaning: "Practicality, comfort", reversed: "Self-centeredness" },
                    { symbol: "💰👔", name: "King of Pentacles", meaning: "Abundance, prosperity", reversed: "Greed, indulgence" }
                ];
            }

            // Settings
            loadSettings() {
                const saved = localStorage.getItem('tarotSettings');
                if (saved) {
                    this.state.settings = { ...this.state.settings, ...JSON.parse(saved) };
                    this.updateUI();
                }
            }

            saveSettings() {
                localStorage.setItem('tarotSettings', JSON.stringify(this.state.settings));
            }

            toggleSound() {
                this.state.settings.soundEnabled = !this.state.settings.soundEnabled;
                document.getElementById('soundToggle').classList.toggle('active');
                document.getElementById('soundIcon').textContent = this.state.settings.soundEnabled ? '🔊' : '🔇';
                this.saveSettings();
            }

            toggleReversals() {
                this.state.settings.reversalsEnabled = !this.state.settings.reversalsEnabled;
                document.getElementById('reversalsToggle').classList.toggle('active');
                this.saveSettings();
            }

            toggleSettings() {
                const panel = document.getElementById('settingsPanel');
                panel.classList.toggle('active');
                if (this.state.settings.apiKey) {
                    document.getElementById('apiKeyInput').value = this.state.settings.apiKey;
                }
            }

            saveApiKey() {
                const apiKey = document.getElementById('apiKeyInput').value.trim();
                if (apiKey) {
                    this.state.settings.apiKey = apiKey;
                    this.saveSettings();
                    this.showMessage('API Key saved successfully!');
                } else {
                    this.showMessage('Please enter a valid API key');
                }
            }

            // History
            loadHistory() {
                const saved = localStorage.getItem('tarotHistory');
                if (saved) {
                    this.state.readingHistory = JSON.parse(saved);
                }
            }

            saveHistory() {
                localStorage.setItem('tarotHistory', JSON.stringify(this.state.readingHistory));
            }

            toggleHistory() {
                const panel = document.getElementById('historyPanel');
                panel.classList.toggle('active');
                this.updateHistoryDisplay();
            }

            updateHistoryDisplay() {
                const list = document.getElementById('historyList');
                if (this.state.readingHistory.length === 0) {
                    list.innerHTML = '<p style="opacity: 0.7; text-align: center;">No readings yet. Start your first reading below!</p>';
                } else {
                    list.innerHTML = this.state.readingHistory.map((reading, i) => `
                        <div style="padding: 15px; margin-bottom: 10px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                            <strong>${new Date(reading.date).toLocaleDateString()}</strong> - ${reading.spreadName}<br>
                            ${reading.question ? `Question: "${reading.question}"<br>` : ''}
                            Cards: ${reading.cards.map(c => c.name).join(', ')}
                        </div>
                    `).join('');
                }
            }

            // Daily Card
            toggleDailyCard() {
                const banner = document.getElementById('dailyCardBanner');
                banner.classList.toggle('active');
                if (banner.classList.contains('active') && !this.state.dailyCard) {
                    this.drawDailyCard();
                }
            }

            drawDailyCard() {
                const shuffled = [...this.tarotDeck].sort(() => Math.random() - 0.5);
                const card = shuffled[0];
                const isReversed = Math.random() > 0.5;
                
                this.state.dailyCard = { ...card, isReversed };
                
                const display = document.getElementById('dailyCardDisplay');
                display.innerHTML = `
                    <div class="card ${isReversed ? 'reversed' : ''}" style="margin: 0 auto;">
                        <div class="card-symbol">${card.symbol}</div>
                        <div class="card-name">${card.name}</div>
                        <div class="card-meaning">${isReversed ? card.reversed : card.meaning}</div>
                    </div>
                `;
            }

            // Deck Explorer
            showDeckExplorer() {
                const modal = document.getElementById('cardModal');
                const title = document.getElementById('modalTitle');
                const body = document.getElementById('modalBody');
                
                title.textContent = 'Complete 78-Card Tarot Deck';
                body.innerHTML = `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <strong>Major Arcana:</strong> 22 cards (0-21)<br>
                        <strong>Minor Arcana:</strong> 56 cards (4 suits × 14 cards)<br>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px;">
                        ${this.tarotDeck.map(card => `
                            <div style="text-align: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                                <div style="font-size: 2rem;">${card.symbol}</div>
                                <div style="font-size: 0.8rem;">${card.name}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                modal.classList.add('active');
            }

            // Insights
            toggleInsights() {
                const panel = document.getElementById('insightsPanel');
                panel.classList.toggle('active');
            }

            // AI Chat
            toggleAIChat() {
                const panel = document.getElementById('aiChatPanel');
                const button = document.querySelector('.ai-chat-button');
                
                if (panel.classList.contains('active')) {
                    this.closeAIChat();
                } else {
                    panel.classList.add('active');
                    button.classList.add('active');
                }
            }

            closeAIChat() {
                document.getElementById('aiChatPanel').classList.remove('active');
                document.querySelector('.ai-chat-button').classList.remove('active');
            }

            sendAIMessage() {
                const input = document.getElementById('aiChatInput');
                const message = input.value.trim();
                if (!message) return;
                
                const messages = document.getElementById('aiChatMessages');
                
                // Add user message
                const userMsg = document.createElement('div');
                userMsg.className = 'user-message';
                userMsg.textContent = message;
                messages.appendChild(userMsg);
                
                // Clear input
                input.value = '';
                
                // Add AI response
                setTimeout(() => {
                    const aiMsg = document.createElement('div');
                    aiMsg.className = 'ai-message';
                    aiMsg.textContent = this.generateAIResponse(message);
                    messages.appendChild(aiMsg);
                    messages.scrollTop = messages.scrollHeight;
                }, 500);
                
                messages.scrollTop = messages.scrollHeight;
            }

            generateAIResponse(message) {
                const lower = message.toLowerCase();
                
                if (lower.includes('death') || lower.includes('tower')) {
                    return 'These cards often represent transformation rather than literal events. They signal the end of one phase and the beginning of another.';
                } else if (lower.includes('reversed')) {
                    return 'Reversed cards often show internal aspects of the upright meaning, or blocked/delayed energy in that area.';
                } else if (lower.includes('love') || lower.includes('relationship')) {
                    return 'In matters of the heart, trust your intuition. The cards reflect energies, not fixed outcomes.';
                } else if (this.state.drawnCards.length > 0) {
                    return `Your ${this.state.drawnCards.length} cards reveal a journey of self-discovery. Each position builds upon the others to tell your story.`;
                } else {
                    return 'I can help you understand card meanings, spread positions, and interpret your readings. Draw some cards and let\'s explore their wisdom together!';
                }
            }

            // Main Functions
            setQuestion(q) {
                document.getElementById('userQuestion').value = q;
            }

            selectSpread(type) {
                this.state.currentSpread = type;
                this.state.userQuestion = document.getElementById('userQuestion').value;
                
                document.getElementById('spreadSelector').style.display = 'none';
                document.getElementById('cardDeck').style.display = 'grid';
            }

            drawCards() {
                if (!this.state.currentSpread) return;
                
                document.getElementById('cardDeck').style.display = 'none';
                document.getElementById('spreadArea').className = 'spread-area active';
                
                const spread = this.spreads[this.state.currentSpread];
                const container = document.getElementById('cardsContainer');
                container.innerHTML = '';
                container.className = `cards-container ${this.state.currentSpread}-card`;
                
                const shuffled = [...this.tarotDeck].sort(() => Math.random() - 0.5);
                this.state.drawnCards = [];
                
                for (let i = 0; i < spread.count; i++) {
                    const card = shuffled[i];
                    const isReversed = this.state.settings.reversalsEnabled ? Math.random() > 0.5 : false;
                    
                    this.state.drawnCards.push({
                        ...card,
                        isReversed,
                        position: spread.positions[i]
                    });
                    
                    setTimeout(() => {
                        const cardDiv = this.createCardElement(card, isReversed, spread.positions[i], i);
                        container.appendChild(cardDiv);
                    }, i * 200);
                }
                
                setTimeout(() => {
                    this.getInterpretation();
                }, spread.count * 200 + 500);
            }

            createCardElement(card, isReversed, position, index) {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'card-position';
                cardDiv.style.animationDelay = `${index * 0.1}s`;
                
                const posLabel = document.createElement('div');
                posLabel.className = 'position-label';
                posLabel.textContent = position;
                
                const cardEl = document.createElement('div');
                cardEl.className = `card ${isReversed ? 'reversed' : ''}`;
                
                const symbolEl = document.createElement('div');
                symbolEl.className = 'card-symbol';
                symbolEl.textContent = card.symbol;
                
                const nameEl = document.createElement('div');
                nameEl.className = 'card-name';
                nameEl.textContent = card.name;
                
                const meaningEl = document.createElement('div');
                meaningEl.className = 'card-meaning';
                meaningEl.textContent = isReversed ? card.reversed : card.meaning;
                
                cardEl.appendChild(symbolEl);
                cardEl.appendChild(nameEl);
                cardEl.appendChild(meaningEl);
                
                cardDiv.appendChild(posLabel);
                cardDiv.appendChild(cardEl);
                
                return cardDiv;
            }

            async getInterpretation() {
                const interpretationDiv = document.getElementById('interpretation');
                const interpretationText = document.getElementById('interpretationText');
                
                interpretationDiv.style.display = 'block';
                interpretationText.innerHTML = '<div class="loading-text"><div class="loading"></div><span>Channeling cosmic wisdom...</span></div>';
                
                const spread = this.spreads[this.state.currentSpread];
                let prompt = `You are an experienced tarot reader providing insightful, personalized interpretations. `;
                
                if (this.state.userQuestion) {
                    prompt += `The querent asks: "${this.state.userQuestion}". `;
                }
                
                prompt += `This is a ${spread.name} spread with the following cards:\n\n`;
                
                this.state.drawnCards.forEach(card => {
                    prompt += `${card.position}: ${card.name} ${card.isReversed ? '(Reversed)' : '(Upright)'}\n`;
                });
                
                prompt += `\nProvide a cohesive interpretation that:
                1. Explains what each card means in its position
                2. Weaves the cards into a unified narrative
                3. Offers practical, actionable insights
                4. Maintains an empowering, constructive tone`;
                
                if (this.state.userQuestion) {
                    prompt += `\n5. Directly addresses the question: "${this.state.userQuestion}"`;
                }
                
                prompt += `\n\nKeep the interpretation to 3-4 insightful paragraphs.`;
                
                const apiKey = this.state.settings.apiKey || 'YOUR-API-KEY';
                
                try {
                    if (apiKey === 'YOUR-API-KEY') {
                        throw new Error('Please configure your Gemini API key in Settings');
                    }
                    
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{ text: prompt }]
                            }],
                            generationConfig: {
                                temperature: 0.7,
                                maxOutputTokens: 1000
                            }
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`API request failed: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    const aiResponse = data.candidates[0].content.parts[0].text;
                    
                    // Use enhanced formatting
                    this.displayInterpretation(aiResponse);
                    
                } catch (error) {
                    console.error('Error getting Gemini interpretation:', error);
                    this.displayFallbackInterpretation();
                }
            }

            // Enhanced interpretation display with beautiful formatting
            displayInterpretation(text) {
                const interpretationText = document.getElementById('interpretationText');
                let html = '';
                
                // Reading Header Section
                html += '<div class="reading-header">';
                
                if (this.state.userQuestion) {
                    html += `
                        <div class="reading-question">
                            <span style="color: var(--golden-accent); font-size: 1.5rem;">❓</span>
                            "${this.state.userQuestion}"
                        </div>
                    `;
                }
                
                html += `
                    <div style="text-align: center; color: var(--astral-teal); font-size: 0.9rem; margin-top: 15px;">
                        ${this.spreads[this.state.currentSpread].name} Spread • ${this.state.drawnCards.length} Cards
                    </div>
                `;
                html += '</div>';
                
                // Cards Drawn Section - Visual Summary
                html += '<div class="cards-drawn-section">';
                this.state.drawnCards.forEach(card => {
                    html += `
                        <div class="card-summary">
                            <div class="card-summary-position">${card.position}</div>
                            <div class="card-summary-name">${card.name}</div>
                            <div class="card-summary-orientation">
                                ${card.isReversed ? '🔄 Reversed' : '⬆️ Upright'}
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                
                // Main Interpretation Content
                html += '<div class="interpretation-content">';
                
                // Parse the AI response into sections
                const sections = this.parseInterpretation(text);
                
                sections.forEach(section => {
                    if (section.title) {
                        html += `<div class="interpretation-section">`;
                        html += `<div class="interpretation-section-title">${section.title}</div>`;
                        html += `<div class="interpretation-text">${section.content}</div>`;
                        html += `</div>`;
                    } else {
                        html += `<div class="interpretation-text">${section.content}</div>`;
                    }
                });
                
                html += '</div>';
                
                // Key Insights/Takeaways
                const insights = this.extractKeyInsights(text);
                if (insights.length > 0) {
                    html += '<div class="key-insights">';
                    html += '<div class="key-insights-title">Key Insights</div>';
                    insights.forEach(insight => {
                        html += `
                            <div class="insight-item">
                                <div class="insight-bullet">•</div>
                                <div class="insight-text">${insight}</div>
                            </div>
                        `;
                    });
                    html += '</div>';
                }
                
                // Footer - Inspirational Close
                html += `
                    <div class="reading-footer">
                        <div class="reading-footer-text">
                            The cards have spoken. May their wisdom illuminate your path forward.
                        </div>
                    </div>
                `;
                
                interpretationText.innerHTML = html;
            }

            // Helper method to parse interpretation into sections
            parseInterpretation(text) {
                const sections = [];
                const paragraphs = text.split('\n\n');
                
                paragraphs.forEach(paragraph => {
                    if (!paragraph.trim()) return;
                    
                    // Check if paragraph starts with a heading-like pattern
                    const headingMatch = paragraph.match(/^([A-Z][^.!?]*[:])(.+)/s);
                    
                    if (headingMatch) {
                        sections.push({
                            title: headingMatch[1].replace(':', ''),
                            content: headingMatch[2].trim()
                        });
                    } else {
                        sections.push({
                            title: null,
                            content: paragraph.trim()
                        });
                    }
                });
                
                return sections;
            }

            // Helper method to extract key insights
            extractKeyInsights(text) {
                const insights = [];
                
                // Look for numbered points, bullet points, or key phrases
                const lines = text.split('\n');
                
                lines.forEach(line => {
                    // Match numbered insights (1., 2., etc.)
                    if (/^\d+\.\s+/.test(line)) {
                        insights.push(line.replace(/^\d+\.\s+/, ''));
                    }
                    // Match bullet points
                    else if (/^[-•*]\s+/.test(line)) {
                        insights.push(line.replace(/^[-•*]\s+/, ''));
                    }
                });
                
                // If no structured insights found, extract key sentences
                if (insights.length === 0) {
                    const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
                    // Take the first and last sentence as key insights
                    if (sentences.length >= 2) {
                        insights.push(sentences[0].trim());
                        insights.push(sentences[sentences.length - 1].trim());
                    }
                }
                
                return insights.slice(0, 5); // Limit to 5 key insights
            }

            displayFallbackInterpretation() {
                const interpretationText = document.getElementById('interpretationText');
                let html = '<div class="error-message">Unable to connect to Gemini AI. ';
                
                const apiKey = this.state.settings.apiKey || 'YOUR-API-KEY';
                if (apiKey === 'YOUR-API-KEY') {
                    html += 'Please add your API key in Settings.<br>';
                    html += '<small>Get a free key at: <a href="https://makersuite.google.com/app/apikey" target="_blank" style="color: #F59E0B;">Google AI Studio</a></small>';
                }
                
                html += '</div>';
                
                if (this.state.userQuestion) {
                    html += `<p><strong>Your Question:</strong> ${this.state.userQuestion}</p>`;
                }
                
                html += '<p><strong>Your Cards:</strong></p>';
                this.state.drawnCards.forEach(card => {
                    html += `<p><strong>${card.position}:</strong> ${card.name} ${card.isReversed ? '(Reversed)' : ''} - ${card.isReversed ? card.reversed : card.meaning}</p>`;
                });
                
                html += '<p><em>The cards have spoken. Their wisdom reveals a path of transformation and growth. Trust your intuition as you navigate the energies they present.</em></p>';
                
                interpretationText.innerHTML = html;
            }

            saveReading() {
                const reading = {
                    date: new Date().toISOString(),
                    spreadName: this.spreads[this.state.currentSpread].name,
                    cards: this.state.drawnCards,
                    question: this.state.userQuestion
                };
                
                this.state.readingHistory.unshift(reading);
                if (this.state.readingHistory.length > 20) {
                    this.state.readingHistory.pop();
                }
                
                this.saveHistory();
                this.showMessage('Reading saved!');
            }

            shareReading() {
                const text = `My ${this.spreads[this.state.currentSpread].name} Tarot Reading:\n${this.state.drawnCards.map(c => `${c.position}: ${c.name}`).join('\n')}`;
                if (navigator.share) {
                    navigator.share({ text });
                } else {
                    navigator.clipboard.writeText(text);
                    this.showMessage('Reading copied to clipboard!');
                }
            }

            resetReading() {
                this.state.currentSpread = null;
                this.state.drawnCards = [];
                this.state.userQuestion = '';
                document.getElementById('userQuestion').value = '';
                document.getElementById('spreadSelector').style.display = 'block';
                document.getElementById('cardDeck').style.display = 'none';
                document.getElementById('spreadArea').className = 'spread-area';
                document.getElementById('interpretation').style.display = 'none';
            }

            closeModal() {
                document.getElementById('cardModal').classList.remove('active');
            }

            showMessage(text) {
                const div = document.createElement('div');
                div.className = 'success-message';
                div.textContent = text;
                div.style.position = 'fixed';
                div.style.top = '30px';
                div.style.left = '50%';
                div.style.transform = 'translateX(-50%)';
                div.style.zIndex = '2000';
                document.body.appendChild(div);
                
                setTimeout(() => {
                    div.remove();
                }, 3000);
            }

            updateUI() {
                document.getElementById('soundIcon').textContent = this.state.settings.soundEnabled ? '🔊' : '🔇';
                document.getElementById('soundToggle').classList.toggle('active', this.state.settings.soundEnabled);
                document.getElementById('reversalsToggle').classList.toggle('active', this.state.settings.reversalsEnabled);
            }
        }

        // Conversion Gateway Controller
        class ConversionGateway {
            constructor() {
                this.state = {
                    email: null,
                    hasAccess: false,
                    trialUsed: false,
                    selectedCard: null,
                    progress: 0
                };
                
                this.loadState();
                this.init();
            }

            init() {
                if (this.state.hasAccess) {
                    this.grantAccess();
                    return;
                }

                this.setupEmailCapture();
                this.startCountdown();
                this.checkProgress();
            }

            loadState() {
                const saved = localStorage.getItem('gatewayState');
                if (saved) {
                    this.state = { ...this.state, ...JSON.parse(saved) };
                }
            }

            saveState() {
                localStorage.setItem('gatewayState', JSON.stringify(this.state));
            }

            setupEmailCapture() {
                const form = document.getElementById('emailForm');
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const email = e.target[0].value;
                    
                    this.state.email = email;
                    this.state.hasAccess = true;
                    this.saveState();
                    
                    console.log('Email captured:', email);
                    this.showAccessGranted();
                });
            }

            startCountdown() {
                let hours = 2, minutes = 47, seconds = 33;
                
                setInterval(() => {
                    if (seconds > 0) {
                        seconds--;
                    } else if (minutes > 0) {
                        minutes--;
                        seconds = 59;
                    } else if (hours > 0) {
                        hours--;
                        minutes = 59;
                        seconds = 59;
                    } else {
                        hours = 2;
                        minutes = 47;
                        seconds = 33;
                    }
                    
                    document.getElementById('hours').textContent = String(hours).padStart(2, '0');
                    document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
                    document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
                }, 1000);
            }

            showAccessGranted() {
                const overlay = document.getElementById('accessGranted');
                overlay.classList.add('show');
                
                setTimeout(() => {
                    this.grantAccess();
                    overlay.classList.remove('show');
                }, 3000);
            }

            grantAccess() {
                document.getElementById('conversionGateway').classList.add('hidden');
                document.getElementById('countdownBar').style.display = 'none';
                document.getElementById('progressIndicator').style.display = 'none';
                
                document.getElementById('mainApp').classList.add('revealed');
                
                const toggle = document.querySelector('.conversion-toggle');
                toggle.textContent = 'Show Gateway';
                
                this.state.hasAccess = true;
                this.saveState();
            }

            updateProgress(amount) {
                this.state.progress = Math.min(100, this.state.progress + amount);
                document.getElementById('progressFill').style.width = `${this.state.progress}%`;
                
                if (this.state.progress >= 100 && !this.state.hasAccess) {
                    this.showAccessGranted();
                }
                
                this.saveState();
            }

            checkProgress() {
                if (this.state.progress > 0) {
                    document.getElementById('progressIndicator').style.display = 'block';
                    document.getElementById('progressFill').style.width = `${this.state.progress}%`;
                }
            }
        }

        // Initialize both systems
        let app;
        const gateway = new ConversionGateway();

        // Initialize app when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                app = new TarotApp();
                window.app = app;
            });
        } else {
            app = new TarotApp();
            window.app = app;
        }

        // Trial functions
        function skipToTrial() {
            document.getElementById('trialSection').style.display = 'block';
            document.getElementById('progressIndicator').style.display = 'block';
            document.querySelector('.capture-card').style.opacity = '0.6';
            window.scrollTo({
                top: document.getElementById('trialSection').offsetTop - 100,
                behavior: 'smooth'
            });
        }

        let selectedCardIndex = null;

        function drawTrialCard(element, index) {
            document.querySelectorAll('.trial-card').forEach(card => {
                card.style.transform = '';
                card.style.boxShadow = '';
            });
            
            element.style.transform = 'translateY(-15px) scale(1.1)';
            element.style.boxShadow = '0 20px 40px rgba(245, 158, 11, 0.5)';
            
            selectedCardIndex = index;
            
            const button = document.getElementById('trialButton');
            button.disabled = false;
            button.textContent = 'Get Your Reading';
            
            gateway.updateProgress(25);
        }

        function performTrialReading() {
            if (selectedCardIndex === null) return;
            
            const messages = [
                "The Moon card reveals hidden truths emerging. Trust your intuition.",
                "The Star brings hope and renewal. Your wishes are manifesting.",
                "The Crystal Ball shows transformation ahead. Embrace the change."
            ];
            
            alert(`Your Reading\n\n${messages[selectedCardIndex]}\n\nSign up for full access to unlock detailed AI interpretations, multiple spreads, and daily guidance!`);
            
            gateway.updateProgress(50);
            gateway.state.trialUsed = true;
            gateway.saveState();
            
            document.querySelector('.capture-card').style.animation = 'pulse 1s ease 3';
            document.querySelector('.email-input').focus();
        }

        function toggleConversion() {
            const gatewayElement = document.getElementById('conversionGateway');
            const mainApp = document.getElementById('mainApp');
            const toggle = document.querySelector('.conversion-toggle');
            
            if (gatewayElement.classList.contains('hidden')) {
                gatewayElement.classList.remove('hidden');
                document.getElementById('countdownBar').style.display = 'flex';
                mainApp.classList.remove('revealed');
                toggle.textContent = 'Skip to App';
            } else {
                gateway.grantAccess();
            }
        }
    </script>
</body>
</html>
